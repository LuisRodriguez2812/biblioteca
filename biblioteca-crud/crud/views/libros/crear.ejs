<%- include('../partials/header') %>
<div class="container mt-4">
  <h1 class="text-center mb-4">Registrar Nuevo Libro</h1>

  <div class="card shadow-lg border-0 rounded-lg">
    <div class="card-body">
      <form action="/libros" method="POST" onsubmit="return validarFormularioLibro();">
        <div class="form-group mb-3">
          <label>Título</label>
          <input type="text" name="titulo" class="form-control" required>
        </div>

        <div class="form-group mb-3">
          <label>Autor</label>
          <input type="text" name="autor" class="form-control" required>
        </div>

        <div class="form-group mb-3">
          <label>ISBN</label>
          <input type="text" name="ISBN" class="form-control" required>
        </div>

        <div class="form-group mb-3">
          <label>Stock</label>
          <input type="number" name="stock" class="form-control" min="1" required>
        </div>

        <div class="form-group mb-4">
          <label>Categoría</label>
          <select name="categoriaId" class="form-control">
            <option value="">Seleccione una categoría</option>
            <% categorias.forEach(categoria => { %>
              <option value="<%= categoria.id %>"><%= categoria.nombre %></option>
            <% }) %>
          </select>
        </div>

        <div class="d-flex justify-content-between">
          <button type="submit" class="btn btn-primary">Guardar Libro</button>
          <a href="/libros" class="btn btn-secondary">Cancelar</a>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  function validarFormularioLibro() {
    const titulo = document.querySelector('[name="titulo"]').value.trim();
    const autor = document.querySelector('[name="autor"]').value.trim();
    const isbn = document.querySelector('[name="ISBN"]').value.trim();
    const stock = document.querySelector('[name="stock"]').value;

    if (!titulo || !autor || !isbn || stock <= 0) {
      alert('Por favor, complete todos los campos correctamente.');
      return false;
    }
    return true;
  }
</script>

<%- include('../partials/footer') %>
